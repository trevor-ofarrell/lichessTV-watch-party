{"ast":null,"code":"import _slicedToArray from\"/home/d9/code/lichessTV-watch-party/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/d9/code/lichessTV-watch-party/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/home/d9/code/lichessTV-watch-party/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _styled from\"@emotion/styled\";import React,{useRef,useState,useEffect}from\"react\";import Chessboard from\"chessboardjsx\";import useChat from\"./useChat\";import useTyping from\"./useTyping\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Input=_styled.input({\"paddingLeft\":\"1rem\",\"paddingRight\":\"1rem\",\"paddingTop\":\"0.5rem\",\"paddingBottom\":\"0.5rem\",\"::placeholder\":{\"--tw-placeholder-opacity\":\"1\",\"color\":\"rgba(160, 174, 192, var(--tw-placeholder-opacity))\"},\"width\":\"auto\",\":focus\":{\"--tw-ring-opacity\":\"1\",\"--tw-ring-color\":\"rgba(162, 115, 255, var(--tw-ring-opacity))\",\"--tw-border-opacity\":\"1\",\"borderColor\":\"rgba(100, 21, 255, var(--tw-border-opacity))\"},\"--tw-border-opacity\":\"1\",\"borderColor\":\"rgba(203, 213, 224, var(--tw-border-opacity))\",\"borderWidth\":\"1px\",\"borderStyle\":\"solid\",\"borderRadius\":\"0.375rem\",\"--tw-shadow\":\"0 0 0 1px rgba(0, 0, 0, 0.05)\",\"boxShadow\":\"var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)\",\"@media (min-width: 1024px)\":{\"marginLeft\":\"auto\",\"marginRight\":\"auto\"}});export var InputTextLeft=_styled(Input)({\"textAlign\":\"left\",\"paddingTop\":\"0.5rem\",\"paddingBottom\":\"0.5rem\"});export var PrimaryButton=function PrimaryButton(_ref){var _ref$className=_ref.className,className=_ref$className===void 0?\"\":_ref$className,children=_ref.children,rest=_objectWithoutProperties(_ref,[\"className\",\"children\"]);return/*#__PURE__*/_jsx(Button,_objectSpread(_objectSpread({className:\"bg-primary-500 hover:bg-primary-300 text-white\"},rest),{},{\"data-testid\":\"btn\",children:children}));};export var Button=function Button(_ref2){var _ref2$className=_ref2.className,className=_ref2$className===void 0?\"\":_ref2$className,children=_ref2.children,rest=_objectWithoutProperties(_ref2,[\"className\",\"children\"]);return/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({className:\"py-2 px-4 focus:outline-none ring-opacity-75 ring-primary-400 focus:ring text-lg rounded-md\"},rest),{},{\"data-testid\":\"btn\",children:children}));};var getWindowDimensions=function getWindowDimensions(){var _window=window,width=_window.innerWidth,height=_window.innerHeight;return{width:width,height:height};};var useWindowDimensions=function useWindowDimensions(){var _useState=useState(getWindowDimensions()),_useState2=_slicedToArray(_useState,2),windowDimensions=_useState2[0],setWindowDimensions=_useState2[1];useEffect(function(){function handleResize(){setWindowDimensions(getWindowDimensions());}window.addEventListener(\"resize\",handleResize);return function(){return window.removeEventListener(\"resize\",handleResize);};},[]);return windowDimensions;};var JoinChat=function JoinChat(props){var roomId=props.roomId,onNameUpdate=props.onNameUpdate;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useTyping=useTyping(),isTyping=_useTyping.isTyping,startTyping=_useTyping.startTyping,stopTyping=_useTyping.stopTyping,cancelTyping=_useTyping.cancelTyping;var _useWindowDimensions=useWindowDimensions(),height=_useWindowDimensions.height,width=_useWindowDimensions.width;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),newMessage=_useState6[0],setNewMessage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),FEN=_useState8[0],setFEN=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),black=_useState10[0],setBlack=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),white=_useState12[0],setWhite=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),userName=_useState14[0],setUserName=_useState14[1];var messageRef=useRef();var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),listening=_useState16[0],setListening=_useState16[1];var _useChat=useChat(roomId,name),messages=_useChat.messages,user=_useChat.user,users=_useChat.users,typingUsers=_useChat.typingUsers,sendMessage=_useChat.sendMessage,startTypingMessage=_useChat.startTypingMessage,stopTypingMessage=_useChat.stopTypingMessage,addUser=_useChat.addUser;var handleKeyUp=function handleKeyUp(event){if(event.key===\"Enter\"){if(newMessage!==\"\"){sendMessage(newMessage,false);setNewMessage(\"\");}}};var createPlayerNames=function createPlayerNames(user,setPlayer){var username=\"\";if(user.user.name){if(user.user.title){username=user.user.title+\" \"+user.user.name+\" \"+user.rating;}else{username=user.user.name+\" \"+user.rating;}setPlayer(username);}};useEffect(function(){return messageRef.current.scrollIntoView({behavior:\"smooth\"});});useEffect(function(){if(!listening){var source;roomId!==\"featured\"?source=new EventSource(\"\".concat(process.env.REACT_APP_API_ENDPOINT,\"/lichesstvcustom/?id=\").concat(roomId)):source=new EventSource(\"\".concat(process.env.REACT_APP_API_ENDPOINT,\"/lichesstv\"));if(roomId!==\"featured\"){source.onmessage=function(event){var parsedData=JSON.parse(event.data);console.log(event.data);setFEN([parsedData.fen]);};}else{source.onmessage=function(event){var parsedData=JSON.parse(event.data);console.log(event.data);setFEN([parsedData.d.fen]);if(parsedData.d.players){createPlayerNames(parsedData.d.players[0],setWhite);createPlayerNames(parsedData.d.players[1],setBlack);}};}setListening(true);}},[listening,FEN]);return/*#__PURE__*/_jsx(\"div\",{style:{height:height,width:width},className:\"ml-auto bg-black overflow-hidden\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"h-full max-h-full flex flex-col xl:items-stretch xl:flex-row overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sm:mt-auto overflow-hidden m-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium md:text-sm text-xs text-white max-w-70 text-left break-all\",children:[\"FEN: \",FEN]}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium md:text-2xl text-lg my-1 text-white\",children:black}),/*#__PURE__*/_jsx(\"div\",{className:\"m-auto\",children:/*#__PURE__*/_jsx(Chessboard,{position:FEN[0],transitionDuration:100,showNotation:false,calcWidth:function calcWidth(size){return size.screenWidth<1440?size.screenHeight/100*46:size.screenWidth>1440?size.screenHeight/100*70:screen.width/100*100;}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium md:text-2xl text-lg my-1 text-white\",children:[\" \",white]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rounded-lg h-full xl:w-2/6 xl:max-h-full max-h-4/12 w-full max-w-full xl:max-w-2/6 pb-14 bg-black ml-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"h-full ml-1 mt-1 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-lg\",children:[\"Room: \",roomId]}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-auto xl:pt-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-white text-center text-lg px-4\",children:\"Create a username to join the chat\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"xl:w-full w-80 overflow-hidden p-4 m-auto\",children:/*#__PURE__*/_jsx(\"input\",{className:\"w-full h-10 pl-3 text-base bg-gray-700 placeholder-white border rounded-lg focus:shadow-outline\",id:\"message\",type:\"text\",label:\"Message\",placeholder:\"enter username\",variant:\"outlined\",value:userName,onChange:function onChange(event){return setUserName(event.target.value);}})})}),/*#__PURE__*/_jsx(\"button\",{className:\"h-12 m-auto flex items-center px-4 font-bold text-white bg-yellow-600 rounded-lg hover:bg-green-600 focus:bg-green-600\",variant:\"contained\",color:\"primary\",onClick:function onClick(){setName(userName);onNameUpdate(userName);addUser(userName);},children:\"Join Chat\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:messageRef})]})})]})});};export default JoinChat;","map":{"version":3,"sources":["/home/d9/code/lichessTV-watch-party/client/src/JoinChat.jsx"],"names":["React","useRef","useState","useEffect","Chessboard","useChat","useTyping","Input","tw","input","InputTextLeft","PrimaryButton","className","children","rest","Button","getWindowDimensions","window","width","innerWidth","height","innerHeight","useWindowDimensions","windowDimensions","setWindowDimensions","handleResize","addEventListener","removeEventListener","JoinChat","props","roomId","onNameUpdate","name","setName","isTyping","startTyping","stopTyping","cancelTyping","newMessage","setNewMessage","FEN","setFEN","black","setBlack","white","setWhite","userName","setUserName","messageRef","listening","setListening","messages","user","users","typingUsers","sendMessage","startTypingMessage","stopTypingMessage","addUser","handleKeyUp","event","key","createPlayerNames","setPlayer","username","title","rating","current","scrollIntoView","behavior","source","EventSource","process","env","REACT_APP_API_ENDPOINT","onmessage","parsedData","JSON","parse","data","console","log","fen","d","players","size","screenWidth","screenHeight","screen","target","value"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport Chessboard from \"chessboardjsx\";\nimport tw from \"twin.macro\";\nimport useChat from \"./useChat\";\nimport useTyping from \"./useTyping\";\n\nexport const Input = tw.input`\n  px-4\n  py-2\n  placeholder-gray-500\n  w-auto\n  lg:mx-auto\n  focus:ring-primary-100\n  focus:border-primary-500\n  border-gray-400\n  border-width[1px]\n  border-solid\n  rounded-md\n  shadow-xs\n`;\n\nexport const InputTextLeft = tw(Input)`text-left py-2`;\n\nexport const PrimaryButton = ({ className = \"\", children, ...rest }) => {\n  return (\n    <Button\n      className={`bg-primary-500 hover:bg-primary-300 text-white`}\n      {...rest}\n      data-testid=\"btn\"\n    >\n      {children}\n    </Button>\n  );\n};\n\nexport const Button = ({ className = \"\", children, ...rest }) => {\n  return (\n    <button\n      className={`py-2 px-4 focus:outline-none ring-opacity-75 ring-primary-400 focus:ring text-lg rounded-md`}\n      {...rest}\n      data-testid=\"btn\"\n    >\n      {children}\n    </button>\n  );\n};\n\nconst getWindowDimensions = () => {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height,\n  };\n};\n\nconst useWindowDimensions = () => {\n  const [windowDimensions, setWindowDimensions] = useState(\n    getWindowDimensions()\n  );\n\n  useEffect(() => {\n    function handleResize() {\n      setWindowDimensions(getWindowDimensions());\n    }\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  return windowDimensions;\n};\n\nconst JoinChat = (props) => {\n  const { roomId, onNameUpdate } = props;\n  const [name, setName] = useState(\"\");\n  const { isTyping, startTyping, stopTyping, cancelTyping } = useTyping();\n  const { height, width } = useWindowDimensions();\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [FEN, setFEN] = useState([]);\n  const [black, setBlack] = useState(\"\");\n  const [white, setWhite] = useState(\"\");\n  const [userName, setUserName] = useState(\"\");\n  const messageRef = useRef();\n  const [listening, setListening] = useState(false);\n  const {\n    messages,\n    user,\n    users,\n    typingUsers,\n    sendMessage,\n    startTypingMessage,\n    stopTypingMessage,\n    addUser,\n  } = useChat(roomId, name);\n\n  const handleKeyUp = (event) => {\n    if (event.key === \"Enter\") {\n      if (newMessage !== \"\") {\n        sendMessage(newMessage, false);\n        setNewMessage(\"\");\n      }\n    }\n  };\n\n  const createPlayerNames = (user, setPlayer) => {\n    let username = \"\";\n    if (user.user.name) {\n      if (user.user.title) {\n        username = user.user.title + \" \" + user.user.name + \" \" + user.rating;\n      } else {\n        username = user.user.name + \" \" + user.rating;\n      }\n      setPlayer(username);\n    }\n  };\n\n  useEffect(() => messageRef.current.scrollIntoView({ behavior: \"smooth\" }));\n\n  useEffect(() => {\n    if (!listening) {\n      let source;\n      roomId !== \"featured\"\n        ? (source = new EventSource(\n            `${process.env.REACT_APP_API_ENDPOINT}/lichesstvcustom/?id=${roomId}`\n          ))\n        : (source = new EventSource(\n            `${process.env.REACT_APP_API_ENDPOINT}/lichesstv`\n          ));\n      if (roomId !== \"featured\") {\n        source.onmessage = (event) => {\n          const parsedData = JSON.parse(event.data);\n          console.log(event.data);\n          setFEN([parsedData.fen]);\n        };\n      } else {\n        source.onmessage = (event) => {\n          const parsedData = JSON.parse(event.data);\n          console.log(event.data);\n          setFEN([parsedData.d.fen]);\n          if (parsedData.d.players) {\n            createPlayerNames(parsedData.d.players[0], setWhite);\n            createPlayerNames(parsedData.d.players[1], setBlack);\n          }\n        };\n      }\n      setListening(true);\n    }\n  }, [listening, FEN]);\n\n  return (\n    <div\n      style={{ height: height, width: width }}\n      className=\"ml-auto bg-black overflow-hidden\"\n    >\n      <div className=\"h-full max-h-full flex flex-col xl:items-stretch xl:flex-row overflow-hidden\">\n        <div className=\"sm:mt-auto overflow-hidden m-auto\">\n          <div className=\"font-medium md:text-sm text-xs text-white max-w-70 text-left break-all\">\n            FEN: {FEN}\n          </div>\n          <div className=\"m-auto\">\n            <div className=\"font-medium md:text-2xl text-lg my-1 text-white\">\n              {black}\n            </div>\n            <div className=\"m-auto\">\n              <Chessboard\n                position={FEN[0]}\n                transitionDuration={100}\n                showNotation={false}\n                calcWidth={(size) =>\n                  size.screenWidth < 1440\n                    ? (size.screenHeight / 100) * 46\n                    : size.screenWidth > 1440\n                    ? (size.screenHeight / 100) * 70\n                    : (screen.width / 100) * 100\n                }\n              />\n            </div>\n            <div className=\"font-medium md:text-2xl text-lg my-1 text-white\">\n              {\" \"}\n              {white}\n            </div>\n          </div>\n        </div>\n        <div className=\"rounded-lg h-full xl:w-2/6 xl:max-h-full max-h-4/12 w-full max-w-full xl:max-w-2/6 pb-14 bg-black ml-auto\">\n          <div className=\"h-full ml-1 mt-1 overflow-y-auto\">\n            <h1 className=\"text-lg\">Room: {roomId}</h1>\n\n            <div className=\"m-auto xl:pt-12\">\n              <div className=\"font-bold text-white text-center text-lg px-4\">\n                Create a username to join the chat\n              </div>\n              <div>\n                <div className=\"xl:w-full w-80 overflow-hidden p-4 m-auto\">\n                  <input\n                    className=\"w-full h-10 pl-3 text-base bg-gray-700 placeholder-white border rounded-lg focus:shadow-outline\"\n                    id=\"message\"\n                    type=\"text\"\n                    label=\"Message\"\n                    placeholder=\"enter username\"\n                    variant=\"outlined\"\n                    value={userName}\n                    onChange={(event) => setUserName(event.target.value)}\n                  />\n                </div>\n              </div>\n              <button\n                className=\"h-12 m-auto flex items-center px-4 font-bold text-white bg-yellow-600 rounded-lg hover:bg-green-600 focus:bg-green-600\"\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={() => {\n                  setName(userName);\n                  onNameUpdate(userName);\n                  addUser(userName);\n                }}\n              >\n                Join Chat\n              </button>\n            </div>\n            <div ref={messageRef}></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default JoinChat;\n"]},"metadata":{},"sourceType":"module"}